<div class="cmd cmd-widget" data-type="action" data-subtype="slider" data-template="button" data-cmd_id="#id#" data-cmd_uid="#uid#" data-version="#version#" data-eqLogic_id="#eqLogic_id#">
  <!-- ################ Slider Vertical Button v1 ################ 
  Widget name : cmd.action.slider.vertical_button_v1
  Author : Phpvarious
  Version : 2023/12/20 19h40
  Link : https://phpvarious.github.io/documentation/widget/fr_FR/action/slider/cmd.action.slider.vertical_button_v1/
  Tested with Jeedom V4.3.20
  from the code : https://codepen.io/jessecfisher/pen/dymYdG
-->
  <div class="title #hide_name#">
    <div class="cmdName">#name_display#</div>
  </div>
  <div class="content-sm">
    <center>
      <div id="typeSlider#id#">
        <input type="text" class="input-sm form-control in_value#id# hidden" value="#state#" disabled/>
        <a id="bt1-#id#" class="btn#id# btn-top#id#"></a>
        <div id="slider-vertical#id#" class="slider slider#id#">
          <div class="value#id#">#state#</div>
        </div>
        <a id="bt2-#id#" class="btn#id# btn-bottom#id#"></a>
      </div>
    </center>
  </div>
  <style>
    :root {
      --width#id# : 40px;
      --height#id# : 100px;
      --bt-background#id# : var(--btnEq-default-color);
      --bt-color#id# : var(--link-color);
      --background#id# : var(--el-defaultColor);
      --slider-background#id# : var(--link-color);
      --text-color#id# : var(--txt-color);
      --font-size#id# : 22px;
      --notif-color#id# : var(--logo-primary-color);
    }
    .slider#id# {
      position: relative;
      height: var(--height#id#) !important;
      display: block;
      width: var(--width#id#) !important;
      border-radius: 0px;
    }
    
    .vertical#id# .slider#id# {
      /* margin: 0 32px !important;*/
      min-width: 18px;
    }
    .horizontal#id# .slider#id#{
      min-width: 40px;
    }
    .slider#id#.ui-slider.ui-state-disabled {
      opacity: 1;
    }
    .slider#id# div.ui-slider-range {
      display: block;
      height: 250px;
      -moz-border-radius: 250px;
      -webkit-border-radius: 250px;
      border-radius: 250px;
    }
    .slider#id#.ui-slider div.ui-slider-range {
      background-color: var(--slider-background#id#) !important;
    }
    .slider#id# .ui-slider-handle.ui-corner-all.ui-state-default {
      display: none;
    }
    .slider#id#.ui-slider.ui-slider-vertical .ui-slider-range {
     width : 100% !important;
     left: 0px;
    }
    
    .slider#id#.ui-slider.ui-slider-horizontal .ui-slider-range {
      height: 100% !important;
    }
    
    .slider#id#.ui-slider .ui-slider-range, .slider#id#.ui-slider .ui-corner-all.ui-slider-range {
      border-radius: 0px !important;
    }
    .slider#id#.slider.ui-slider {
      background: var(--background#id#) !important;
      cursor: pointer;
    }
    
    .horizontal#id# .slider#id#.slider.ui-slider {
      cursor: col-resize;
    }
    .vertical#id# .slider#id#.slider.ui-slider {
      cursor: row-resize;
    }
    
    .horizontal#id# .slider#id#.slider.ui-slider {
      float: left;
      /* margin: 0px !important;*/
    }
    .slider#id#.slider.ui-slider {
      margin: 0px !important;
    }
    
    .btn#id# {
      display: inline-block;
      color: var(--bt-color#id#) !important;
      background-color: var(--bt-background#id#) !important;
      
      line-height: 16px;
      font-size: 18px;
      padding-top: 5px;
      min-width: 18px;
    }
    .vertical#id# .btn#id# {
      width: var(--width#id#);
      height: 28px;
    }
    .horizontal#id# .btn#id# {
      width: 28px;
      height: var(--height#id#);
    }
    .vertical#id# .btn-top#id# {
      border-radius: 10px 10px 0px 0px;
    }
    .horizontal#id# .btn-top#id# {
      border-radius: 10px 0px 0px 10px;
      display: grid;
      align-content: center;
      padding-top: 0px;
      float: left;
      margin-left: 10px;
    }
    .vertical#id# .btn-bottom#id# {
      border-radius: 0px 0px 10px 10px;
    }
    .horizontal#id# .btn-bottom#id# {
      border-radius: 0px 10px 10px 0px;
      display: grid;
      align-content: center;
      padding-top: 0px;
      float: left;
      margin-right: 10px;
    }
    .value#id# {
      position: absolute;
      top: 50%;
      z-index: 2;
      background-color: transparent !important;
      width: var(--width#id#) !important;
      font-size: var(--font-size#id#) !important;
      color: var(--text-color#id#) !important;
      text-align: center;
      font-weight: bold;
      line-height: 0px;
      min-width: 18px;
      white-space: nowrap;
      -webkit-user-select: none;
      -webkit-touch-callout: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
    }
    .horizontal#id# .value#id# {
      min-width: 40px;
    }
  </style>
  <template>
    <div>width : Largeur du slider. [ défaut : 40 ]</div>
    <div>height : Hauteur du slider. [ défaut : 100 ]</div>
    <div>step : Pas utilisé pour le changement de valeur. [ défaut : 1 ]</div>
    <div>backgroundBt : Couleur de fond des boutons. [ défaut : couleur du Core ]</div>
    <div>colorBt : Couleur des icones des boutons. [ défaut : couleur du Core ]</div>
    <div>backgroundSlider : Couleur de fond du slider. [ défaut : couleur du Core ]</div>
    <div>colorCurseur : Couleur du slider. [ défaut : couleur du Core ]</div>
    <div>colorValue : Couleur du texte. [ défaut : couleur du Core ]</div>
    <div>sizeValue : Taille du texte de la valeur. [ défaut : 18 ]</div>
    <div>hideValue : Masque la valeur lorsque qu'il n'y a pas de mouvement du curseur. [ défaut : 0 ]</div>
    <div>notifUpdate : Change la couleur de la valeur lors d'un update. [ défaut : 1 ]</div>
    <div>notifUpdateColor : Couleur de la valeur lors d'un update. [ défaut : #96c927 ]</div>
    <div>horizontal : Affiche le slider horizontalement. [ défaut : 0 (vertical) ]</div>
    <div>disableSlider : Désactive le slider. [ défaut : 0 (activé) ]</div>
  </template>
  <script>
    var step#id# = 1
    var showValue#id# = true
    var notifUpdate#id# = true
    var maxSizeValue#id# = 22
    var width#id# = 40
    var type#id# = 'vertical'
    var disableSlider#id# = false
    
    if (is_numeric('#width#')) {
      document.documentElement.style.setProperty('--width#id#', '#width#' + 'px')
      width#id# = parseInt('#width#')
      if (width#id# < 18) width#id# = 18
    }
    if (is_numeric('#height#')) document.documentElement.style.setProperty('--height#id#', '#height#' + 'px')
    if ($.issetWidgetOptParam('#step#', 'step')) step#id# = parseFloat('#step#')
    if ($.issetWidgetOptParam('#backgroundBt#', 'backgroundBt')) document.documentElement.style.setProperty('--bt-background#id#', '#backgroundBt#')
    if ($.issetWidgetOptParam('#colorBt#', 'colorBt')) document.documentElement.style.setProperty('--bt-color#id#', '#colorBt#')
    if ($.issetWidgetOptParam('#backgroundSlider#', 'backgroundSlider')) document.documentElement.style.setProperty('--background#id#', '#backgroundSlider#')
    if ($.issetWidgetOptParam('#colorCurseur#', 'colorCurseur')) document.documentElement.style.setProperty('--slider-background#id#', '#colorCurseur#')
    if ($.issetWidgetOptParam('#colorValue#', 'colorValue')) document.documentElement.style.setProperty('--text-color#id#', '#colorValue#')
    if (is_numeric('#sizeValue#')) {
      maxSizeValue#id# = (parseInt('#sizeValue#') > parseInt(width#id# * 0.57)) ? parseInt(width#id# * 0.57) : parseInt('#sizeValue#')
      document.documentElement.style.setProperty('--font-size#id#', maxSizeValue#id# + 'px')
    }
    if (is_numeric('#hideValue#') && '#hideValue#' == '1') {
      showValue#id# = false
      $('.cmd[data-cmd_uid=#uid#]').find('.value#id#').hide()
    }
    if (is_numeric('#notifUpdate#') && '#notifUpdate#' == '0') notifUpdate#id# = false
    if ($.issetWidgetOptParam('#notifUpdateColor#', 'notifUpdateColor')) document.documentElement.style.setProperty('--notif-color#id#', '#notifUpdateColor#')
    
    if ('#horizontal#' == '1') type#id# = 'horizontal'
    document.getElementById('typeSlider#id#').className = type#id# + '#id#'
    
    if (type#id# == 'vertical') {
      document.getElementById('bt1-#id#').classList.add("bt_plus");
      document.getElementById('bt2-#id#').classList.add("bt_minus");
      $('#bt1-#id#').empty().append('<i class="fa fa-plus">')
      $('#bt2-#id#').empty().append('<i class="fas fa-minus">')
    }
    else
    {
      document.getElementById('bt1-#id#').classList.add("bt_minus");
      document.getElementById('bt2-#id#').classList.add("bt_plus");
      $('#bt1-#id#').empty().append('<i class="fas fa-minus">')
      $('#bt2-#id#').empty().append('<i class="fa fa-plus">')
    }
    
    if ('#disableSlider#' == '1') disableSlider#id# = true
    
    
    $( "#slider-vertical#id#" ).slider({
      orientation: type#id#,
      range: "min",
      min: #minValue#,
      max: #maxValue#,
      disabled : disableSlider#id#,
      value: ('#state#' == '') ? #minValue# : '#state#',
      unite: '#unite#',
      step: step#id#,
      slide: function( event, ui ) {
        $('.cmd[data-cmd_uid=#uid#] .in_value#id#').val(ui.value)
        $('.cmd[data-cmd_uid=#uid#]').find('.value#id#').empty().append(ui.value)
      },
      start: function( event, ui ) {
        if (!showValue#id#) $('.cmd[data-cmd_uid=#uid#]').find('.value#id#').show()
      },
      stop: function( event, ui ) {
        jeedom.cmd.execute({id: '#id#', value: {slider: $('.cmd[data-cmd_uid=#uid#] .in_value#id#').val()}})
      }
    })
    
    jeedom.cmd.addUpdateFunction('#id#', function(_options) {
      let sliderValue = $( "#slider-vertical#id#" ).slider( "option", "value" )
      let cmd = $('.cmd[data-cmd_uid=#uid#]')
      let position = _options.value
      let minValue = ('#minValue#' == '') ? 0 : parseInt('#minValue#')
      let maxValue = ('#maxValue#' == '') ? 100 : parseInt('#maxValue#')
      if (!showValue#id#) $('.cmd[data-cmd_uid=#uid#]').find('.value#id#').hide()
      
      if(!isset(_options.trigger) && showValue#id# && notifUpdate#id#) {
        $('.cmd[data-cmd_uid=#uid#]').find('.value#id#').attr('style', 'color: var(--notif-color#id#) !important')
        setTimeout(function () {
          $('.cmd[data-cmd_uid=#uid#]').find('.value#id#').css('color', '')
        }, 900)
      }
      if (position != sliderValue) {
        $( "#slider-vertical#id#" ).slider( "value", position )
        $('.cmd[data-cmd_uid=#uid#] .in_value#id#').val(position)
        $('.cmd[data-cmd_uid=#uid#]').find('.value#id#').empty().append(position)
      }
    });
    
    $('.cmd[data-cmd_uid=#uid#] .bt_plus').on('click', function () {
      let max = ('#maxValue#' == '') ?  100 : parseFloat('#maxValue#')
      let step = (isNaN(parseFloat('#step#'))) ?  1 : parseFloat('#step#')
      if (parseFloat($('.cmd[data-cmd_uid=#uid#] .in_value#id#').val()) <= max - step ) {
        jeedom.cmd.refreshValue([{cmd_id :'#id#',value: parseFloat($('.cmd[data-cmd_uid=#uid#] .in_value#id#').val()) + step, trigger :'bt_plus'}] )
        $('.cmd[data-cmd_uid=#uid#] .in_value#id#').trigger('change')
      }
    })
    
    $('.cmd[data-cmd_uid=#uid#] .bt_minus').on('click', function () {
      let min = ('#minValue#' == '') ? 0 : parseFloat('#minValue#')
      let step = (isNaN(parseFloat('#step#'))) ?  1 : parseFloat('#step#')
      if (parseFloat($('.cmd[data-cmd_uid=#uid#] .in_value#id#').val()) >= min + step) {
        jeedom.cmd.refreshValue([{cmd_id :'#id#',value: parseFloat($('.cmd[data-cmd_uid=#uid#] .in_value#id#').val()) - step, trigger :'bt_minus'}])
        $('.cmd[data-cmd_uid=#uid#] .in_value#id#').trigger('change')
      }
    })
    
    $('.cmd[data-cmd_uid=#uid#] .in_value#id#').on('change', function () {
      if (!showValue#id#) $('.cmd[data-cmd_uid=#uid#]').find('.value#id#').show()
      if (typeof timerHandle#uid# !== 'undefined') {
        clearTimeout(timerHandle#uid#)
      }
      timerHandle#uid# = setTimeout(function() {
        jeedom.cmd.execute({id: '#id#', value: {slider: $('.cmd[data-cmd_uid=#uid#] .in_value#id#').val()}})
      }, 1000)
    })
    
    jeedom.cmd.refreshValue([{cmd_id:'#id#', value: '#state#', display_value: '#state#', valueDate: '#valueDate#', collectDate: '#collectDate#', alertLevel: '#alertLevel#', unit: '#unite#', trigger :'init'}])
  </script>
</div>